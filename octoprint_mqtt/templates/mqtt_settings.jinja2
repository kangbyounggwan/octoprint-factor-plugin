<div id="settings_plugin_factor_mqtt">
  <form class="form-horizontal" autocomplete="off">
    <div class="row">
      <!-- 왼쪽 칼럼: 브로커 설정 -->
      <div class="col-xs-12 col-sm-6">
        <h4>MQTT 브로커 설정</h4>

        <div class="form-group">
          <label for="mqtt_broker_host" class="control-label col-sm-4">브로커 호스트</label>
          <div class="col-sm-8">
            <input id="mqtt_broker_host" type="text" class="form-control"
                   placeholder="localhost"
                   data-bind="value: brokerHost">
            <p class="help-block">MQTT 브로커의 호스트명 또는 IP 주소</p>
          </div>
        </div>

        <div class="form-group">
          <label for="mqtt_broker_port" class="control-label col-sm-4">브로커 포트</label>
          <div class="col-sm-8">
            <input id="mqtt_broker_port" type="number" min="1" max="65535"
                   class="form-control" placeholder="1883"
                   data-bind="value: brokerPort">
            <p class="help-block">기본값: 1883</p>
          </div>
        </div>

        <div class="form-group">
          <label for="mqtt_broker_username" class="control-label col-sm-4">사용자명</label>
          <div class="col-sm-8">
            <input id="mqtt_broker_username" type="text" class="form-control"
                   placeholder="(선택)"
                   data-bind="value: brokerUsername">
          </div>
        </div>

        <div class="form-group">
          <label for="mqtt_broker_password" class="control-label col-sm-4">비밀번호</label>
          <div class="col-sm-8">
            <input id="mqtt_broker_password" type="password" class="form-control"
                   placeholder="(선택)"
                   data-bind="value: brokerPassword">
          </div>
        </div>

        <div class="form-group">
          <label for="mqtt_topic_prefix" class="control-label col-sm-4">토픽 접두사</label>
          <div class="col-sm-8">
            <input id="mqtt_topic_prefix" type="text" class="form-control"
                   placeholder="octoprint"
                   data-bind="value: topicPrefix">
            <p class="help-block">모든 발행 토픽 앞에 붙는 접두사</p>
          </div>
        </div>
      </div>

      <!-- 오른쪽 칼럼: 발행 설정 -->
      <div class="col-xs-12 col-sm-6">
        <h4>발행 설정</h4>

        <div class="form-group">
          <label for="mqtt_qos_level" class="control-label col-sm-4">QoS 레벨</label>
          <div class="col-sm-8">
            <select id="mqtt_qos_level" class="form-control" data-bind="value: qosLevel">
              <option value="0">0 - 최대 한 번 (at most once)</option>
              <option value="1">1 - 최소 한 번 (at least once)</option>
              <option value="2">2 - 정확히 한 번 (exactly once)</option>
            </select>
            <p class="help-block">메시지 전달 보장 수준을 선택하세요.</p>
          </div>
        </div>

        <div class="form-group">
          <div class="col-sm-offset-4 col-sm-8">
            <div class="checkbox">
              <label>
                <input id="mqtt_retain_messages" type="checkbox"
                       data-bind="checked: retainMessages">
                메시지 유지(Retain)
              </label>
            </div>
          </div>
        </div>

        <h5 class="m-t-sm">발행할 이벤트</h5>

        <div class="form-group">
          <div class="col-sm-offset-4 col-sm-8">
            <div class="checkbox">
              <label>
                <input id="mqtt_publish_status" type="checkbox"
                       data-bind="checked: publishStatus">
                프린터 상태 변경
              </label>
            </div>

            <div class="checkbox">
              <label>
                <input id="mqtt_publish_progress" type="checkbox"
                       data-bind="checked: publishProgress">
                인쇄 진행률
              </label>
            </div>

            <div class="checkbox">
              <label>
                <input id="mqtt_publish_temperature" type="checkbox"
                       data-bind="checked: publishTemperature">
                온도 정보
              </label>
            </div>

            <div class="checkbox">
              <label>
                <input id="mqtt_publish_gcode" type="checkbox"
                       data-bind="checked: publishGcode">
                G-code 명령
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <hr>

    <!-- 하단: 연결 상태 & 테스트 -->
    <div class="row">
      <div class="col-xs-12">
        <h4>연결 상태</h4>
        <div id="mqtt_connection_status"
             class="alert"
             data-bind="css: connectionAlertClass">
          <span class="glyphicon"
                data-bind="css: connectionIconClass"></span>
          <span data-bind="text: connectionStatus">
            MQTT 연결 상태를 확인하는 중...
          </span>
        </div>

        <button type="button"
                id="mqtt_test_connection"
                class="btn btn-primary"
                data-bind="click: testConnection, enable: canTest">
          <span class="glyphicon glyphicon-refresh"></span>
          연결 테스트
        </button>
      </div>
    </div>
  </form>
</div>
